<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>UsenetStreamer Control Panel</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <main class="container">
    <header>
      <h1>UsenetStreamer Control Panel</h1>
      <p class="subtitle">Configure addon credentials, NNTP triage settings, and grab the manifest URL without editing environment files by hand.</p>
    </header>

    <section class="card">
      <h2>Authentication</h2>
      <p class="hint">Enter the shared addon token (the same one you use in the manifest URL). It will be stored locally in your browser.</p>
      <div class="field-row">
        <label for="tokenInput">Addon Token</label>
        <input id="tokenInput" type="text" autocomplete="off" />
      </div>
      <button id="loadConfig" class="primary">Load Configuration</button>
      <p id="authError" class="error hidden"></p>
    </section>

    <section class="card hidden" id="configSection">
      <div class="manifest-row">
        <div>
          <strong>Manifest URL</strong>
          <p id="manifestDescription" class="hint">Add this URL to Stremio once HTTPS and token are set.</p>
        </div>
        <div class="manifest-link">
          <a id="manifestLink" href="#" target="_blank" rel="noopener">Not configured</a>
        </div>
      </div>

      <form id="configForm">
        <section class="group">
          <h3>Indexer Manager</h3>
          <div class="field-grid">
            <label>Manager Type
              <select name="INDEXER_MANAGER">
                <option value="prowlarr">Prowlarr</option>
                <option value="nzbhydra">NZBHydra</option>
              </select>
            </label>
            <label>Manager URL
              <input name="INDEXER_MANAGER_URL" type="url" placeholder="http://localhost:9696" />
            </label>
            <label>API Key
              <input name="INDEXER_MANAGER_API_KEY" type="text" autocomplete="off" />
            </label>
            <label>Indexer IDs (comma separated)
              <input name="INDEXER_MANAGER_INDEXERS" type="text" placeholder="-1 or sci-fi,4k" />
            </label>
            <label class="checkbox">
              <input name="INDEXER_MANAGER_STRICT_ID_MATCH" type="checkbox" />
              <span>Strict ID Matching Only</span>
            </label>
          </div>
        </section>

        <section class="group">
          <h3>NZBDav Connection</h3>
          <div class="field-grid">
            <label>NZBDav URL
              <input name="NZBDAV_URL" type="url" placeholder="http://localhost:3000" />
            </label>
            <label>NZBDav API Key
              <input name="NZBDAV_API_KEY" type="text" autocomplete="off" />
            </label>
            <label>WebDAV URL
              <input name="NZBDAV_WEBDAV_URL" type="url" placeholder="http://localhost:3000" />
            </label>
            <label>WebDAV User
              <input name="NZBDAV_WEBDAV_USER" type="text" />
            </label>
            <label>WebDAV Password
              <input name="NZBDAV_WEBDAV_PASS" type="password" autocomplete="new-password" />
            </label>
            <label>Base Category
              <input name="NZBDAV_CATEGORY" type="text" placeholder="Stremio" />
            </label>
            <label>Movies Category
              <input name="NZBDAV_CATEGORY_MOVIES" type="text" placeholder="Movies" />
            </label>
            <label>Series Category
              <input name="NZBDAV_CATEGORY_SERIES" type="text" placeholder="Tv" />
            </label>
          </div>
        </section>

        <section class="group">
          <h3>NNTP &amp; Triage</h3>
          <div class="field-grid">
            <label class="checkbox">
              <input name="NZB_TRIAGE_ENABLED" type="checkbox" />
              <span>Enable NNTP Health Checks</span>
            </label>
            <label>NNTP Host
              <input name="NZB_TRIAGE_NNTP_HOST" type="text" placeholder="news.easynews.com" />
            </label>
            <label>NNTP Port
              <input name="NZB_TRIAGE_NNTP_PORT" type="number" min="1" placeholder="563" />
            </label>
            <label class="checkbox">
              <input name="NZB_TRIAGE_NNTP_TLS" type="checkbox" />
              <span>Use TLS</span>
            </label>
            <label>NNTP Username
              <input name="NZB_TRIAGE_NNTP_USER" type="text" autocomplete="off" />
            </label>
            <label>NNTP Password
              <input name="NZB_TRIAGE_NNTP_PASS" type="password" autocomplete="new-password" />
            </label>
            <label>Max Candidates
              <input name="NZB_TRIAGE_MAX_CANDIDATES" type="number" min="1" step="1" />
            </label>
            <label>Max NNTP Connections
              <input name="NZB_TRIAGE_MAX_CONNECTIONS" type="number" min="1" step="1" />
            </label>
          </div>
        </section>

        <section class="group">
          <h3>Addon Metadata</h3>
          <div class="field-grid">
            <label>Public Base URL
              <input name="ADDON_BASE_URL" type="url" placeholder="https://example.com" />
            </label>
            <label>Shared Secret
              <input name="ADDON_SHARED_SECRET" type="text" autocomplete="off" />
            </label>
          </div>
        </section>

        <div class="actions">
          <button type="submit" class="primary">Save &amp; Restart</button>
          <span id="saveStatus" class="status-message"></span>
        </div>
      </form>
    </section>
  </main>
  <script src="app.js"></script>
</body>
</html>
